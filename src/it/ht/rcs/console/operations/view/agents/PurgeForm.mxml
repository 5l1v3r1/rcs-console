<?xml version="1.0" encoding="utf-8"?>
<s:TitleWindow xmlns:fx="http://ns.adobe.com/mxml/2009"
							 xmlns:s="library://ns.adobe.com/flex/spark"
							 xmlns:mx="library://ns.adobe.com/flex/mx"
							 width="330"
							 height="230"
							 close="closeMe(event)"
							 title="{R.get('PURGE')}"
							 creationComplete="init(event)">
	<fx:Script>
		<![CDATA[
			import it.ht.rcs.console.agent.controller.AgentManager;
			import it.ht.rcs.console.agent.model.Agent;
			import it.ht.rcs.console.events.SessionEvent;
			import it.ht.rcs.console.update.controller.CoreManager;
			import it.ht.rcs.console.utils.Clock;
			import it.ht.rcs.console.utils.AlertPopUp;

			import locale.R;

			import mx.collections.ListCollectionView;
			import mx.core.FlexGlobals;
			import mx.events.CloseEvent;
			import mx.events.FlexEvent;
			import mx.managers.PopUpManager;
			import mx.rpc.events.FaultEvent;
			import mx.rpc.events.ResultEvent;

			[Bindable]
			public var agent:Agent;

			[Bindable]
			private var upgradable:Boolean;

			protected function closeMe(event:*):void
			{
				PopUpManager.removePopUp(this);
			}

			protected function init(event:FlexEvent):void
			{

			}

			private function purge(event:*):void
			{
				var time:Number=Clock.instance.toUTCTime(dateSelector.selectedDate) / 1000;
				var size:Number=sizeSelector.value * 1024
				AgentManager.instance.purge(agent._id, time, size, onPurgeResult, onPurgeFault)
			}

			private function onPurgeResult(e:ResultEvent):void
			{
				AlertPopUp.show(R.get('PURGE_SUCCESS'),"",0x4,this, closeMe);
			}

			private function onPurgeFault(e:FaultEvent):void
			{
				AlertPopUp.show(e.fault.faultString);
			}
		]]>
	</fx:Script>
	<s:VGroup top="10"
						left="10"
						right="10"
						horizontalAlign="center">
		<s:RichText fontSize="12"
								width="100%"
								text="{R.get('PURGE_DESC')}"/>
		<s:Form>
			<s:FormItem label="{R.get('DATE')}: {R.get('BEFORE')}">
				<s:HGroup verticalAlign="middle">
					
					<mx:DateField disabledRanges="{[{rangeStart: new Date()}]}"
												id="dateSelector"
												selectedDate="{new Date()}"/>
				</s:HGroup>
			</s:FormItem>
			<s:FormItem label="{R.get('SIZE')}: {R.get('BIGGER_THAN')}">
				<s:HGroup verticalAlign="middle">
				
					<s:NumericStepper minimum="1"
														maximum="10000"
														id="sizeSelector"/>
					<s:Label text="KB"/>
				</s:HGroup>
			</s:FormItem>
		</s:Form>
	</s:VGroup>

	<s:HGroup bottom="10"
						width="100%"
						horizontalAlign="center">
		<s:Button id="upBtn"
							label="{R.get('PURGE')}"
							click="purge(event)"/>
		<s:Button label="{R.get('CANCEL')}"
							click="closeMe(event)"/>
	</s:HGroup>

</s:TitleWindow>
