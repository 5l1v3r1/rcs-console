<?xml version="1.0" encoding="utf-8"?>
<events:EventFields xmlns:fx="http://ns.adobe.com/mxml/2009"
                    xmlns:s="library://ns.adobe.com/flex/spark"
                    xmlns:mx="library://ns.adobe.com/flex/mx"
                    xmlns:events="it.ht.rcs.console.operations.view.configuration.advanced.forms.events.*"
                    creationComplete="init()">
  
  <fx:Script>
    <![CDATA[
      import spark.events.IndexChangeEvent;

      private function init():void
      {
        currentState = event.type;
        
        for each (var key:String in ArrayCollection(type.dataProvider).source)
          if (key.toLowerCase().indexOf(currentState) != -1)
            type.selectedItem = key;
        
        switch (currentState) {
          case 'gps':
            latitude.text  = event.latitude;
            longitude.text = event.longitude;
            distance.text  = event.distance;
            break;
          case 'cell':
            country.text = event.country;
            network.text = event.network;
            area.text    = event.area;
            cellId.text  = event.id;
            break;  
          default: break;
        }
      }
      
      override public function commit():void
      {
        event.type = currentState;
        
        switch (currentState) {
          case 'gps':
            event.latitude  = parseFloat(latitude.text);
            event.longitude = parseFloat(longitude.text);
            event.distance  = parseFloat(distance.text);
            break;
          case 'cell':
            event.country = parseInt(country.text);
            event.network = parseInt(network.text);
            event.area    = parseInt(area.text);
            event.id      = parseInt(cellId.text);
            break;  
          default: break;
        }
      }
      
      private function onChange(event:IndexChangeEvent):void
      {
        currentState = states[type.selectedIndex].name;
      }
    ]]>
  </fx:Script>
  
  <events:states>
    <s:State name="gps"/>
    <s:State name="cell"/>
  </events:states>
  
  <s:Form>
    
    <s:FormItem label="Type">
      <s:DropDownList id="type" change="onChange(event)" requireSelection="true">
        <s:dataProvider>
          <s:ArrayCollection>
            <fx:String>GPS</fx:String>
            <fx:String>GSM Cell</fx:String>
          </s:ArrayCollection>
        </s:dataProvider>
      </s:DropDownList>
    </s:FormItem>
    
    <s:FormItem includeIn="gps" label="Latitude">
      <s:TextInput id="latitude" restrict="0-9" textAlign="center" widthInChars="5"/>
    </s:FormItem>
    
    <s:FormItem includeIn="gps" label="Logitude">
      <s:TextInput id="longitude" restrict="0-9" textAlign="center" widthInChars="5"/>
    </s:FormItem>
    
    <s:FormItem includeIn="gps" label="Distance">
      <s:HGroup verticalAlign="middle">
        <s:TextInput id="distance" restrict="0-9" textAlign="center" widthInChars="5"/>
        <s:Label paddingTop="1" text=" meters"/>
      </s:HGroup>
    </s:FormItem>
    
    
    <s:FormItem includeIn="cell" label="Country">
      <s:TextInput id="country" restrict="0-9" textAlign="center" widthInChars="3"/>
    </s:FormItem>
    
    <s:FormItem includeIn="cell" label="Network">
      <s:TextInput id="network" restrict="0-9" textAlign="center" widthInChars="3"/>
    </s:FormItem>
    
    <s:FormItem includeIn="cell" label="Area">
      <s:TextInput id="area" restrict="0-9" textAlign="center" widthInChars="3"/>
    </s:FormItem>
    
    <s:FormItem includeIn="cell" label="ID">
      <s:TextInput id="cellId" restrict="0-9" textAlign="center" widthInChars="3"/>
    </s:FormItem>
    
  </s:Form>

</events:EventFields>