<?xml version="1.0" encoding="utf-8"?>
<s:BorderContainer xmlns:fx="http://ns.adobe.com/mxml/2009"
									 xmlns:s="library://ns.adobe.com/flex/spark"
									 xmlns:mx="library://ns.adobe.com/flex/mx"
                   xmlns:html="flash.html.*"
									 height="100%"
									 width="100%"
                   borderColor="0xCCCCCC"
                   backgroundColor="0xFFFFFF"
                   backgroundAlpha="1" 
                   creationComplete="init()">
	<fx:Script>
		<![CDATA[
			import flashx.textLayout.conversion.TextConverter;
			
			import it.ht.rcs.console.utils.Size;
      
      private var html:HTMLLoader = new HTMLLoader();

			private var _evidence:Object;

			[Bindable]
			public function set evidence(value:Object):void
			{
        _evidence=value;
       
        //html.addEventListener(Event.COMPLETE, onLoadingComplete)
          
        //html.loadString(value.data.content);
        
        var loader:URLLoader=new URLLoader()
        var req:URLRequest=new URLRequest("http://www.repubblica.it")
        loader.addEventListener(Event.COMPLETE, onLoadingComplete)
        //loader.load(req)
        
			}
      
      
      private function onLoadingComplete(e:Event):void
      {
        var cleanHTML:String=e.currentTarget.data.replace(new RegExp("<img.*?(</img>|/>)", "g"), "<img/>");    
        html.loadString(cleanHTML)
        
      }

			public function get evidence():Object
			{
				return _evidence; //from, rcpt,subject, size, content
			}

			private function lineBreak(s:String):String
			{
				var result:String=s.replace(new RegExp("\n", "g"), "<br>");
				return result;
			}
      private function init():void
      {
        
        html.width=htmlBox.width;
        html.height=htmlBox.height;
        htmlBox.addChild(html)
      }
      private function scaleHTML(e:Event):void
      {
        html.width=htmlBox.width;
        html.height=htmlBox.height;
      }
		]]>
	</fx:Script>
<s:layout>
  <s:VerticalLayout paddingBottom="10"
                    paddingLeft="10"
                    paddingRight="10"
                    paddingTop="10"
                    />
</s:layout>
  <s:RichText id="fromTxt" width="100%" textFlow="{TextConverter.importToFlow('&lt;b&gt;From: &lt;/b&gt;'+evidence.data.from, TextConverter.TEXT_FIELD_HTML_FORMAT)}" fontSize="15"/>
  <s:Line width="100%">
    <s:stroke>
      <s:SolidColorStroke color="0xCCCCCC"/>
    </s:stroke>
  </s:Line>
  <s:RichText id="rcptTxt" width="100%" textFlow="{TextConverter.importToFlow('&lt;b&gt;Recipients: &lt;/b&gt;'+evidence.data.rcpt, TextConverter.TEXT_FIELD_HTML_FORMAT)}" fontSize="15"/>
  <s:Line width="100%">
    <s:stroke>
      <s:SolidColorStroke color="0xCCCCCC"/>
    </s:stroke>
  </s:Line>
 <s:RichText id="subjectTxt" width="100%" textFlow="{TextConverter.importToFlow('&lt;b&gt;Subject: &lt;/b&gt;'+evidence.data.subject, TextConverter.TEXT_FIELD_HTML_FORMAT)}" fontSize="15"/>
  <s:Line width="100%">
    <s:stroke>
      <s:SolidColorStroke color="0xCCCCCC"/>
    </s:stroke>
  </s:Line>
  <mx:UIComponent id="htmlBox" width="100%" height="100%" resize="scaleHTML(event)"/>
  
 <!--<s:Scroller height="100%"
              width="100%">
    
    <s:RichEditableText editable="false"
                        id="contentTxt" textFlow="{TextConverter.importToFlow('&lt;b&gt;Content: &lt;/b&gt;&lt;br&gt;'+lineBreak(evidence.data.content), TextConverter.TEXT_FIELD_HTML_FORMAT)}" fontSize="15"/>
  </s:Scroller>-->
</s:BorderContainer>
