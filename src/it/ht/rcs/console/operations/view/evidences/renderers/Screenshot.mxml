<?xml version="1.0" encoding="utf-8"?>
<renderers:EvidenceDataRenderer xmlns:fx="http://ns.adobe.com/mxml/2009"
                                xmlns:s="library://ns.adobe.com/flex/spark"
                                xmlns:mx="library://ns.adobe.com/flex/mx"
                                xmlns:renderers="it.ht.rcs.console.operations.view.evidences.renderers.*"
                                creationComplete="init()">
	
	<fx:Script>
		<![CDATA[
      import it.ht.rcs.console.DB;
      import it.ht.rcs.console.evidence.controller.EvidenceManager;
      import it.ht.rcs.console.utils.ImageCache;
      
  		private var _loader:Loader=new Loader();
      private var _maxWidth:Number=80;
      private var _maxHeight:Number=80;
      
  		
      [Bindable]
      override public function set data(value:*):void
      {
        
        super.data=value;
        
        var id:String=encodeURIComponent(data.data._grid);
        var target:String=encodeURIComponent(EvidenceManager.instance.evidenceFilter.target);
        var url:String=DB.hostAutocomplete(Console.currentSession.server) + "grid/"+ data.data._grid +"?target_id="+target;
        
        img.source=url;
        
        //actually no data!
        programTxt.text="[Program]";//programTxt.text=data.data.program;
        windowTxt.text="[Window]";//windowTxt.text=data.data.window;
     
  		}
      
      private function init():void
      {
        trace("screenshot renderer init")
        img.smooth=false;
        img.contentLoader=ImageCache.getInstance().cache;
        img.addEventListener(ProgressEvent.PROGRESS, onImageLoading)
        img.addEventListener(Event.COMPLETE, onImageLoaded)
        img.addEventListener(IOErrorEvent.IO_ERROR, onImageError);
      }

  		private function onImageLoading(e:ProgressEvent):void
  		{
        trace("image loading");
       
  		}
      
      private function onImageError(e:IOErrorEvent):void
      {
        trace("image error");
      }
  		
  		private function onImageLoaded(e:Event):void
  		{
        trace("image loaded");

  		}
		]]>
	</fx:Script>
  
	    <s:HGroup verticalAlign="middle" paddingBottom="4" paddingLeft="4" paddingRight="4" paddingTop="4">
  			<s:BitmapImage id="img" width="80" height="80" scaleMode="zoom">
          <s:mask>
            <s:BorderContainer id="bmpMask"
                               cornerRadius="{5}"
                               width="{img.width}" height="{img.height}"/>
          </s:mask>
        </s:BitmapImage>
        <s:Label id="programTxt"/>
        <s:Label id="windowTxt"/>
		  </s:HGroup>

</renderers:EvidenceDataRenderer>
