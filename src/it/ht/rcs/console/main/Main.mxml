<?xml version="1.0" encoding="utf-8"?>
<s:Group xmlns:fx="http://ns.adobe.com/mxml/2009"
         xmlns:s="library://ns.adobe.com/flex/spark"
         xmlns:mx="library://ns.adobe.com/flex/mx"
         xmlns:main="it.ht.rcs.console.main.*"
         width="100%" height="100%" addedToStage="onAddedToStage()"
         removedFromStage="onRemovedFromStage()">
  
  <fx:Script>
    <![CDATA[
      import it.ht.rcs.console.events.SectionEvent;
      
      import mx.collections.ArrayList;
      import mx.core.FlexGlobals;
      
      [Bindable]
      private var mainSections:ArrayList;
      
      private function onAddedToStage():void
      {
        FlexGlobals.topLevelApplication.addEventListener(SectionEvent.CHANGE_SECTION, changeSection);
        
        /* different view based on privileges */
        mainSections = new ArrayList();
        Initialization.initialize(mainSections);
      }
      
      private function onRemovedFromStage():void 
      {
        FlexGlobals.topLevelApplication.removeEventListener(SectionEvent.CHANGE_SECTION, changeSection);
      }
      
      private function changeSection(event:SectionEvent):void
      {
        /* change the state to the current section */
        sections.currentState = event.section;
        
        /* check if the new section has an handler to manage the event */
        if (sections[event.section].hasOwnProperty('changeSection'))
          sections[event.section].changeSection(event);
      }
    ]]>
  </fx:Script>
  
  <s:layout>
    <s:VerticalLayout gap="0" paddingBottom="10" paddingLeft="10" paddingRight="10"/>
  </s:layout>
  
  <main:MenuSection sections="{mainSections}"/>
  
  <!-- <main:MenuSubSection/> -->
  
  <main:Sections id="sections"/>
  
</s:Group>